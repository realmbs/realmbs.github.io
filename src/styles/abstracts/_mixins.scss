// ============================================
// MIXINS
// Reusable style patterns
// ============================================

@use 'sass:map';
@use 'sass:math';
@use 'variables' as *;

// --------------------------------------------
// RESPONSIVE BREAKPOINTS
// Mobile-first media queries
// --------------------------------------------

/// Apply styles at a minimum width (mobile-first)
/// @param {String} $breakpoint - Breakpoint name (sm, md, lg, xl, 2xl)
@mixin breakpoint($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    @media (min-width: map.get($breakpoints, $breakpoint)) {
      @content;
    }
  } @else {
    @error 'Unknown breakpoint: #{$breakpoint}. Available: sm, md, lg, xl, 2xl';
  }
}

/// Apply styles below a breakpoint
/// @param {String} $breakpoint - Breakpoint name
@mixin breakpoint-down($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    @media (max-width: map.get($breakpoints, $breakpoint) - 0.02px) {
      @content;
    }
  } @else {
    @error 'Unknown breakpoint: #{$breakpoint}';
  }
}

/// Apply styles between two breakpoints
/// @param {String} $min - Lower breakpoint
/// @param {String} $max - Upper breakpoint
@mixin breakpoint-between($min, $max) {
  @if map.has-key($breakpoints, $min) and map.has-key($breakpoints, $max) {
    @media (min-width: map.get($breakpoints, $min)) and (max-width: map.get($breakpoints, $max) - 0.02px) {
      @content;
    }
  } @else {
    @error 'Unknown breakpoint(s): #{$min}, #{$max}';
  }
}

// --------------------------------------------
// FLEXBOX UTILITIES
// --------------------------------------------

/// Flexbox center (both axes)
@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

/// Flexbox vertical center only
@mixin flex-center-vertical {
  display: flex;
  align-items: center;
}

/// Flexbox horizontal center only
@mixin flex-center-horizontal {
  display: flex;
  justify-content: center;
}

/// Flexbox space-between with vertical center
@mixin flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/// Flexbox column layout
@mixin flex-column {
  display: flex;
  flex-direction: column;
}

/// Flexbox column with center alignment
@mixin flex-column-center {
  display: flex;
  flex-direction: column;
  align-items: center;
}

// --------------------------------------------
// GRID UTILITIES
// --------------------------------------------

/// CSS Grid auto-fit columns
/// @param {Number} $min-width - Minimum column width
/// @param {Number} $gap - Gap between items
@mixin grid-auto-fit($min-width: 280px, $gap: $spacing-4) {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));
  gap: $gap;
}

/// CSS Grid auto-fill columns
/// @param {Number} $min-width - Minimum column width
/// @param {Number} $gap - Gap between items
@mixin grid-auto-fill($min-width: 280px, $gap: $spacing-4) {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax($min-width, 1fr));
  gap: $gap;
}

/// CSS Grid with fixed columns
/// @param {Number} $columns - Number of columns
/// @param {Number} $gap - Gap between items
@mixin grid-columns($columns: 3, $gap: $spacing-4) {
  display: grid;
  grid-template-columns: repeat($columns, 1fr);
  gap: $gap;
}

// --------------------------------------------
// TYPOGRAPHY
// --------------------------------------------

/// Apply heading styles
/// @param {Number} $size - Font size
/// @param {Number} $weight - Font weight
/// @param {Number} $line-height - Line height
@mixin heading($size: $font-size-2xl, $weight: $font-weight-bold, $line-height: $line-height-tight) {
  font-size: $size;
  font-weight: $weight;
  line-height: $line-height;
}

/// Truncate text with ellipsis
@mixin truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/// Multi-line text truncation
/// @param {Number} $lines - Number of lines to show
@mixin line-clamp($lines: 2) {
  display: -webkit-box;
  -webkit-line-clamp: $lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

// --------------------------------------------
// VISUAL EFFECTS
// --------------------------------------------

/// Smooth transition helper
/// @param {List} $properties - CSS properties to transition
/// @param {Number} $duration - Transition duration
@mixin transition($properties: all, $duration: $transition-base) {
  transition-property: $properties;
  transition-duration: $duration;
  transition-timing-function: ease;
}

/// Focus visible outline for accessibility
@mixin focus-ring {
  &:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }
}

/// Visually hidden but accessible
@mixin visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/// Reset button styles
@mixin button-reset {
  appearance: none;
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  font: inherit;
  color: inherit;
  cursor: pointer;
}

/// Reset list styles
@mixin list-reset {
  list-style: none;
  margin: 0;
  padding: 0;
}

// --------------------------------------------
// LAYOUT
// --------------------------------------------

/// Absolute positioning cover
@mixin absolute-cover {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}

/// Fixed positioning cover
@mixin fixed-cover {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}

/// Maintain aspect ratio (legacy support)
/// @param {Number} $width - Aspect ratio width
/// @param {Number} $height - Aspect ratio height
@mixin aspect-ratio($width: 16, $height: 9) {
  aspect-ratio: #{$width} / #{$height};

  // Fallback for older browsers
  @supports not (aspect-ratio: 1) {
    &::before {
      content: '';
      display: block;
      padding-top: percentage(math.div($height, $width));
    }
  }
}
